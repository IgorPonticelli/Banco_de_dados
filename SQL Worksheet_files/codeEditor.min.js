const EditorView=CodeMirror.codemirror.EditorView,{sql:sql,PLSQL:PLSQL}=CodeMirror["@codemirror/lang-sql"],view=CodeMirror["@codemirror/view"],state=CodeMirror["@codemirror/state"],language=CodeMirror["@codemirror/language"],commands=CodeMirror["@codemirror/commands"],search=CodeMirror["@codemirror/search"],autocomplete=CodeMirror["@codemirror/autocomplete"],Compartment=CodeMirror["@codemirror/state"].Compartment,getClassFromTheme=e=>"dark"===e?"cm-dark":"cm-light",getConfigurableExtensions=e=>{const t=[];var o;return"dark"===e.theme&&t.push(CodeMirror["@codemirror/theme-one-dark"].oneDark),t.push(EditorView.editorAttributes.of({class:(o=e.theme,"dark"===o?"cm-dark":"cm-light")})),t.push(state.EditorState.readOnly.of(e.readOnly)),e.lineNumbers&&(t.push(view.lineNumbers()),t.push(language.foldGutter())),e.closeBrackets&&t.push(autocomplete.closeBrackets()),t};class CodeEditor{#changeListeners=[];constructor(e,t={},o=[]){this.options={language:"sql",theme:"light",readOnly:!1,lineNumbers:!0,closeBrackets:!0,...t},this.optionsCompartment=new Compartment,this.editorView=new EditorView({extensions:[...o,this.optionsCompartment.of(getConfigurableExtensions(this.options)),CodeMirror["@codemirror/language"].indentUnit.of("    "),view.keymap.of([{key:"Tab",run:commands.insertTab,shift:commands.indentLess}]),EditorView.updateListener.of((e=>{if(e.docChanged&&this.#changeListeners.length){const t=e.state.doc.toString();this.#changeListeners.forEach((e=>{e(t)}))}})),view.highlightActiveLineGutter(),view.highlightSpecialChars(),commands.history(),view.drawSelection(),view.dropCursor(),state.EditorState.allowMultipleSelections.of(!0),language.indentOnInput(),language.syntaxHighlighting(language.defaultHighlightStyle,{fallback:!0}),language.bracketMatching(),view.rectangularSelection(),view.crosshairCursor(),view.highlightActiveLine(),search.highlightSelectionMatches(),view.keymap.of([...commands.defaultKeymap,...search.searchKeymap,...commands.historyKeymap,...language.foldKeymap]),..."sql"===this.options.language?[sql({dialect:PLSQL})]:[]],parent:document.getElementById(e)}),CodeEditor[e]=this}getValue(){return this.editorView.state.doc.toString()}setValue(e){this.editorView.dispatch({changes:{from:0,to:this.editorView.state.doc.length,insert:e}})}setOptions(e){this.options={...this.options,...e},this.editorView.dispatch({effects:this.optionsCompartment.reconfigure(getConfigurableExtensions(this.options))})}getSelection(){const e=this.editorView.state;return e.sliceDoc(e.selection.main.from,e.selection.main.to)}getEditor(){return this.editorView}focus(){this.editorView.focus()}setCursorToEnd(){const e=this.getValue().length;this.editorView.dispatch({selection:{anchor:e,head:e}})}onChange(e){this.#changeListeners.push(e)}}window.codeEditor=CodeEditor;