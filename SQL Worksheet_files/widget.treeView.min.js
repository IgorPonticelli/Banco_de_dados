!function(e,t,i,s,n){"use strict";const o="a-TreeView",r="a-TreeView-node",l="."+r,a="a-TreeView-row",d="."+a,h="a-TreeView-content",c="."+h,p=c+", "+d,f="a-TreeView-toggle",u="."+f,g="a-TreeView-placeholder",m="u-selector",v=".u-selector",_="is-selected",w=".is-selected",b="is-disabled",y="is-focused",C="is-hover",x="is-expandable",N="is-collapsible",I="is-processing",S="a-TreeView-node--leaf",k="u-RTL",A="a-TreeView-input",P="."+A,T=":visible",D="aria-expanded",E="aria-selected",O="is-active",M="aria-disabled",V="aria-level",F="tree",L="none",R="<ul role='group'>",H="</ul>",K="true",W="false",$="#action$",B="selectionChange",q=n.ui.keyCode,j=n.extend,X=t.hasOwnProperty,Y=e=>parseInt(e,10);function U(){return new Error("Unsupported by model")}function z(){return new Error("Parent node required")}function G(e,t){let i="",s=e.className.split(" ");for(let e=0;e<s.length;e++){let o=s[e];n.inArray(o,t)>=0&&(i+=" "+o)}e.className=i.substr(1)}function Q(e){return e.parent().children(T).index(e)}function Z(e){let t=e.get(0).id;return t.substring(t.lastIndexOf("_")+1)}function J(e,t){return Y(e.children(c).find(t).attr(V))}function ee(e,t){return Y(e.find(t).attr(V))}let te=null;function ie(e,t,i,s,n){if(i.renderNodeContent)i.renderNodeContent(t,e,s,n);else{let o,r,l,a,d;s.nodeSelector>0&&(a=m,1===s.nodeSelector&&(a+=" u-selector--single"),e.markup('<span class="'+a+'"></span>')),i.getIcon&&(o=i.getIcon(t),null!==o&&e.markup("<span").attr("class",s.iconType+" "+o).markup("></span>")),r=s.useLinks&&i.getLink&&i.getLink(t),r&&r.startsWith($)&&(d=r.substring($.length),r=null),r?(te&&r.match(/^#\S*$/)&&(r=te+r),l="a"):l="span",e.markup("<"+l+" tabIndex='-1' role='"+"treeitem'").attr("class",s.labelClass).optionalAttr("href",r).optionalAttr("data-action",d).attr(V,n.level).attr(E,n.selected?K:W).optionalAttr(M,n.disabled?K:null).optionalAttr(D,!1===n.hasChildren?null:n.expanded?K:W).markup(">").content(i.getLabel(t)).markup("</"+l+">")}}function se(e){e.tabIndex=0,e.focus()}function ne(e){let t;return e.hasClass(N)&&(t=e.children("ul").children("li").filter(T).first()),t&&t[0]||(t=e.nextAll(T).first(),0===t.length&&(t=e.parent().parents("li").nextAll("li").filter(T).first())),t}function oe(e){let t;if(t=e.prevAll(T).first(),t.length>0){if(t.hasClass(N)){let e=t.find("li").filter(T).last();e[0]&&(t=e)}}else t=e.parent().parent("li");return t}function re(e,t,i,s,o){var r=e.val(t).width(i).keydown((function(e){var t=e.which;e.shiftKey||e.ctrlKey||e.altKey||(t===q.ENTER?(s(n(this).val(),!0),e.preventDefault()):t===q.ESCAPE&&(setTimeout((function(){o(!0)}),10),e.preventDefault()))})).blur((function(){s(n(this).val(),!1)}))[0];return se(r),r.select(),r}n("base").length&&(te=window.location.pathname+window.location.search);var le={begin:function(){this.text="<ul>\r\n"},node:function(e,i,s){this.text+="<li>"+t.escapeHTML(s)+"</li>\r\n"},end:function(){this.text+="</ul>\r\n"},toString:function(){return this.text}};n.widget("apex.treeView",n.ui.mouse,j(!0,{version:"19.1",widgetEventPrefix:"treeview",options:{getNodeAdapter:null,adapterTypesMap:null,showRoot:!0,expandRoot:!0,collapsibleRoot:!0,autoCollapse:!1,useLinks:!0,multiple:!1,nodeSelector:!1,allowCopy:!0,dataTransferFormats:[{format:"text/plain",writer:Object.create({begin:function(){this.text=""},node:function(e,t,i){t>0&&(this.text+="\r\n"),this.text+=i},end:function(){},toString:function(){return this.text}})},{format:"text/html",writer:Object.create(le)}],idPrefix:null,iconType:"a-Icon",labelClass:"a-TreeView-label",doubleClick:!1,clickToRename:!1,keyboardRename:!1,keyboardAdd:!1,keyboardDelete:!1,tooltip:null,navigation:!1,actionsContext:null,dragAndDrop:!1,dragMultiple:!1,dragReorder:!1,dragAppendTo:"parent",dragContainment:!1,dragCursor:"auto",dragCursorAt:!1,dragHelper:null,dragOpacity:!1,dragAnimate:!1,dragExpandDelay:1200,dragScroll:!0,dragScrollSensitivity:20,dragScrollSpeed:10,dragZIndex:1e3,scope:"default",activate:null,deactivate:null,out:null,over:null,start:null,drag:null,beforeStop:null,stop:null,selectionChange:null,expansionStateChange:null,activateNode:null,beginEdit:null,endEdit:null,added:null,renamed:null,deleted:null,moved:null,copied:null},scrollTimerId:null,delayExpandTimer:null,hasCurrent:!1,tooltipOptions:null,triggerTimerId:null,forwardKey:q.RIGHT,backwardKey:q.LEFT,scrollParent:null,animating:!1,dragging:!1,dragItems:null,currentItem:null,_create:function(){let e=this,i=this.element,r=this.options;if(r.getNodeAdapter||(r.getNodeAdapter=this._parseTreeMarkup(i,r.adapterTypesMap||null)),!r.getNodeAdapter)throw new Error("Missing required option getNodeAdapter");this.actionsContext=r.actionsContext=r.actionsContext||s,this.nodeAdapter=r.getNodeAdapter(),this.nodeAdapter.setView&&this.nodeAdapter.setView(i),this.containerCache={},!1===r.collapsibleRoot&&(r.expandRoot=!0),i.addClass(o).attr("role",F),this.baseId=(r.idPrefix||i[0].id||F)+"_",this.labelSelector="."+r.labelClass,this.lazyExpandQueue=[];this._delayExpand=t.debounce((()=>{for(;this.lazyExpandQueue.length>0;){let e=this.lazyExpandQueue.shift();this._expandNode(n("#"+e),(()=>{}))}}),50),this.editMode=!1,r.multiple&&i.attr("aria-multiselectable",K),this.rtlFactor=1,"rtl"===i.css("direction")&&(i.addClass(k),this.forwardKey=q.LEFT,this.backwardKey=q.RIGHT,this.rtlFactor=-1),r.disabled&&i.attr(M,K),r.tooltip&&this._initTooltips(r.tooltip),this._initContextMenu(c,(function(t){return n(t.target).closest("a").length>0||e.editMode}),(function(t){let i="keydown"===t.type&&e.lastFocused?e.lastFocused:t.target,s=n(i).closest(c);return!!s.length&&(!!s.hasClass(_)||s)}),(function(t){t.selectedNodes=e.getNodes(t.selection),t.treeNodeAdapter=e.nodeAdapter})),this.scrollParent=i.scrollParent(),this.offset=this.element.offset(),this._mouseInit(),this._on(this._eventHandlers),r.allowCopy&&apex.clipboard.addHandler(i[0],(function(t){return!e.editMode&&(e._copy(t),!0)})),this._selNotifyDelay=t.debounce(this._selChangeNotify,1),this._selNotifyLongDelay=t.debounce(this._selChangeNotify,350),this._setOption("disabled",r.disabled),this.refresh()},_eventHandlers:{click:function(e){var t,i,s=this.options,o=n(e.target);if(s.multiple||"A"!==e.target.nodeName||!e.shiftKey&&!e.ctrlKey){if(o.hasClass(m))t=o.closest(l),e.ctrlKey=!0,e.shiftKey=!1,this._select(t.children(c),e,!0),e.preventDefault();else if(o.hasClass(f))this._toggleNode(o.parent()),this.scrollParent&&(r=this.scrollParent,a=r.scrollTop(),d=r,h=null,r[0]===document&&(d=n(window)),d.on("scroll.treeTemp",(function(){r.scrollTop(a),d.off(".treeTemp"),clearTimeout(h)})),h=setTimeout((function(){d.off(".treeTemp")}),20)),this.lastFocused.focus(),e.preventDefault();else if((t=o.closest(l)).length>0){if(i=t.children(c),this.editMode&&i.hasClass(_))return;s.clickToRename&&i.find(this.labelSelector).attr(E)===K&&!e.ctrlKey&&!e.altKey&&1===this.getSelection().length&&o.closest(this.labelSelector).length?this.renameNodeInPlace(i):(this._select(i,e,!0),s.navigation&&(this.keyboardActivate||"activate"!==s.doubleClick)&&this._activate(e,t)),e.preventDefault()}var r,a,d,h,p;this.keyboardActivate=!1,p={},window.getSelection?p=window.getSelection():document.selection&&(p=document.selection.createRange()),p.rangeCount?p.removeAllRanges():p.text>""&&document.selection.empty()}else this.keyboardActivate=!1},dblclick:function(e){var t,i=this.options.doubleClick;i&&!this.editMode&&(t=n(e.target).closest(l)).length>0&&("toggle"===i?(this._toggleNode(t),e.preventDefault()):"activate"===i&&this._activate(e,t))},keydown:function(e){var t,i,s,o,r,a=this,h=this.options,p=this.element,f=e.which;e.altKey||"INPUT"===e.target.nodeName||this.dragging||(f!==q.PAGE_UP&&f!==q.PAGE_DOWN||(this.scrollParent?(s=p.find(d).filter(T).first().outerHeight()||24,t=p.find("li").filter(T).first(),s+=Y(t.css("margin-top"))+Y(t.css("margin-bottom")),o=this.scrollParent[0]===document?n(window).height():this.scrollParent[0].clientHeight,r=Math.floor(o/s)-1):r=10),f===q.HOME?(p.find(c).filter(T).first().each((function(){a._select(n(this),e,!0,!0)})),e.preventDefault()):f===q.END?(p.find(c).filter(T).last().each((function(){a._select(n(this),e,!0,!0)})),e.preventDefault()):f===q.SPACE?(this.lastFocused&&this._select(n(a.lastFocused).closest(c),e,!0,!0),e.preventDefault()):f===q.DOWN?(this._traverseDown(e,1),e.preventDefault()):f===q.UP?(this._traverseUp(e,1),e.preventDefault(),e.stopPropagation()):f===q.PAGE_DOWN?(this._traverseDown(e,r),e.preventDefault()):f===q.PAGE_UP?(this._traverseUp(e,r),e.preventDefault()):f===this.backwardKey?(this.lastFocused&&((t=n(this.lastFocused).closest(l)).hasClass(N)?this._collapseNode(t):t.parent().prevAll(c).each((function(){a._select(n(this),e,!0,!0)}))),e.preventDefault()):f===this.forwardKey?(this.lastFocused&&((t=n(this.lastFocused).closest(l)).hasClass(x)?this._expandNode(t):t.hasClass(N)&&t.children("ul").children("li").first().children(c).each((function(){a._select(n(this),e,!0,!0)}))),e.preventDefault()):f===q.ENTER?"A"===e.target.nodeName||e.shiftKey||e.ctrlKey?this.keyboardActivate=!0:(t=n(this.lastFocused).closest(l),this._activate(e,t),e.preventDefault()):113===f&&h.keyboardRename?(i=this.lastFocused&&n(this.lastFocused).closest(c+w).length>0?n(this.lastFocused).closest(c):this.getSelection().first()).length>0&&this.renameNodeInPlace(i):45===f&&h.keyboardAdd?(i=this.lastFocused&&n(this.lastFocused).closest(c+w).length>0?n(this.lastFocused).closest(c):this.getSelection().first()).length>0&&this.addNodeInPlace(i):f===q.DELETE&&h.keyboardDelete&&this.deleteNodes(this.getSelection()))},keypress:function(e){var t,i,s=this;if(!(0===e.which||e.ctrlKey||e.altKey||"INPUT"===e.target.nodeName||this.dragging)){if(t=String.fromCharCode(e.which).toLowerCase(),this.searchTimerId)t!==this.searchString&&(this.searchString+=t),clearTimeout(this.searchTimerId),this.searchTimerId=null;else{if(" "===t)return;this.searchString=t}this.searchTimerId=setTimeout((function(){s.searchTimerId=null}),500),(i=function(e){var t,i,o,r=e.length;function a(){0===(i=ne(i)).length&&(i=s.element.find(l).filter(T).first())}for(i=t=n(s.lastFocused).closest(l),1===r&&a();;){if((o=i.children(c).find(s.labelSelector).first()).text().substring(0,r).toLowerCase()===e)return o.closest(c);if(a(),i[0]===t[0])break}return null}(this.searchString))&&this._select(i,e,!0,!0)}},focusin:function(e){var t=n(e.target).closest(this.labelSelector);t.length&&(t.addClass(y).closest(l).children(d).addClass(y),this._setFocusable(t))},focusout:function(e){n(e.target).closest(this.labelSelector).removeClass(y).closest(l).children(d).removeClass(y)},mousemove:function(e){var t;this.dragging||(t=n(e.target).closest(l)).length&&this.lastHover!==t[0]&&(n(this.lastHover).children(p).removeClass(C),t.children(p).addClass(C),this.lastHover=t[0])},mouseleave:function(){this.dragging||this.lastHover&&(n(this.lastHover).children(p).removeClass(C),this.lastHover=null)}},_setOption:function(e,t){let o,r=this.options,l=r.nodeSelector;if(this._checkContextMenuOptions(e,t),"disabled"===e)r[e]=t,this.widget().toggleClass(b,!!t),t?(this.element.attr(M,K),this.lastFocused&&(this.lastFocused.tabIndex=-1),this.lastFocused=null):(this.element.removeAttr(M),o=this.getSelection().first().find(this.labelSelector),o.length||(o=this.element.find(this.labelSelector).first()),this._setFocusable(o));else{if("allowCopy"===e)throw new Error("TreeView "+e+" cannot be set");if("dragMultiple"===e&&t&&!r.multiple)throw new Error("TreeView dragMultiple cannot be true when the multiple option is false");if("multiple"===e&&!t&&r.dragMultiple)throw new Error("TreeView multiple cannot be false when the dragMultiple option is true");if("collapsibleRoot"===e)throw new Error("TreeView collapsibleRoot option cannot be set");this._super(e,t)}r=this.options,r.multiple&&!r.nodeSelector&&apex.userHasTouched()&&(r.nodeSelector=!0),this.renderNodeOptions={iconType:r.iconType,labelClass:r.labelClass,useLinks:r.useLinks,nodeSelector:r.nodeSelector?r.multiple?2:1:0},"showRoot"===e||"useLinks"===e||r.nodeSelector!==l||"multiple"===e&&r.nodeSelector?this.refresh():"getNodeAdapter"===e?(this.nodeAdapter=r.getNodeAdapter(),this.refresh()):"multiple"===e?(this.element.attr("aria-multiselectable",t?K:W),!1===t&&this.getSelection().length>0&&this._select(n(this.lastFocused).closest(c),null,!1,!1)):"expandRoot"===e&&!1===t?!1===r.collapsibleRoot&&(r.expandRoot=!0,i.warn("ExpandRoot option cannot be false when collapsibleRoot is false")):"tooltip"===e?this._initTooltips(t):"actionsContext"===e&&(this.actionsContext=t||s)},_initTooltips:function(e){var t,s=this;n.ui.tooltip?(this.tooltipOptions&&(this.element.tooltip("destroy"),this.tooltipOptions=null),e&&((t=this.tooltipOptions=j(!0,{},e)).items=this.labelSelector,t.content&&n.isFunction(t.content)&&(t._originalContent=t.content,t.content=function(e){var i=s.getNodes(n(this).closest(c))[0];return t._originalContent.call(this,e,i)}),this.element.tooltip(t))):i.warn("tooltip option ignored because missing tooltip widget dependency")},_destroy:function(){var e=this.element;e.empty().removeClass("a-TreeView u-RTL").removeAttr("role").removeAttr("aria-multiselectable"),apex.clipboard.removeHandler(e[0]),this._destroyContextMenu(),this.options.tooltip&&n.ui.tooltip&&e.tooltip("destroy"),this._mouseDestroy()},refresh:function(e){let i,s,o,r=this,a=this.options,d=this.nodeAdapter,h=null,c=this.element,p=t.htmlBuilder();const f=()=>{h&&h.length>0?this.setSelectedNodes(h,!1,!0):(this.selectAnchor=this.lastFocused,this._setFocusable(c.find(this.labelSelector).first()))};if(d.getViewId&&(h=this.getSelectedNodes()),e)e.each((function(){var e=n(this).parent(),t=r.treeMap[Z(e)];e.find(l).addBack().each((function(){delete r.treeMap[Z(n(this))]})),p.clear(),r._renderNode(t,J(e,r.labelSelector),p),e.replaceWith(p.toString())}));else{if(this.treeMap={},this.nextNodeId=0,d.clearViewId&&d.clearViewId(this.baseId),i=d.root(),i)p.markup(R),a.showRoot?this._renderNode(i,1,p):d.hasChildren(i)&&this._renderChildren(i,1,p),p.markup(H),c.html(p.toString());else if(p.markup(R),p.markup(H),c.html(p.toString()),d.fetchChildNodes&&d.modelId)return void d.fetchChildNodes(null,(()=>{f()}));a.expandRoot&&a.showRoot&&(s=this._getRoots(),s.length>0&&this._expandNode(s))}this.hasCurrent?(o=this.find({depth:-1,match:function(e){return!0===e.current}}),this.hasCurrent=!1,this.setSelection(o)):f()},getNodeAdapter:function(){return this.nodeAdapter},focus:function(){this.lastFocused&&this.lastFocused.focus()},getTreeNode:function(e){var t,i=this.nodeAdapter;if(!i.getViewId)throw U();return t=i.getViewId(this.baseId,e),n("#"+this.baseId+t).children(c)},getSelection:function(){return this.element.find(c+w)},getNodes:function(e){var t=this,i=[];return e.each((function(){var e=Z(n(this).closest("li"));"new"!==e&&i.push(t.treeMap[e])})),i},getSelectedNodes:function(){return this.getNodes(this.getSelection())},setSelection:function(e,t,i){t=!!t,this.options.multiple||(e=e.first()),this._select(e,null,t,!1,i)},setSelectedNodes:function(e,t,s){var o,r,l,a=[],d=this.nodeAdapter;if(!d.getViewId)throw U();for(t=!!t,this.options.multiple||(e=[e[0]]),o=0;o<e.length;o++)r=d.getViewId(this.baseId,e[o]),(l=n("#"+this.baseId+r).children(c)[0])?a.push(l):i.warn("TreeView: Ignoring bad node in setSelectedNodes");this._select(n(a),null,t,!1,s)},getExpandedNodeIds:function(){var e=this.nodeAdapter;if(!e.getExpandedNodeIds)throw U();return e.getExpandedNodeIds(this.baseId)},getExpandedState:function(){var e=this.nodeAdapter;if(!e.getExpandedState)throw U();return e.getExpandedState(this.baseId)},find:function(e){return n(this._find(e.parentNodeContent$||null,e.match,e.depth||1,e.findAll||!1))},expand:function(e){var t=this;e||(e=this._getRoots().children(c)),e.each((function(){var e=n(this).closest(l);e.hasClass(x)&&t._expandNode(e)}))},expandAll:function(e){var t=this;e||(e=this._getRoots().children(c)),e.each((function(){var e=n(this).closest(l);e.hasClass(x)?t._expandNode(e,(function(){t.expandAll(e.children("ul").children("li").children(c))})):t.expandAll(e.children("ul").children("li").children(c))}))},collapse:function(e){var t=this;e||(e=this._getRoots().children(c)),e.each((function(){var e=n(this).closest(l);e.hasClass(N)&&t._collapseNode(e)}))},collapseAll:function(e){var t=this;e||(e=this._getRoots().children(c)),e.each((function(){var e=n(this).closest(l);t.collapseAll(e.children("ul").children("li").children(c)),e.hasClass(N)&&t._collapseNode(e)}))},addNodeInPlace:function(e,i,s){var o,l,d,p,f=this,u=this.element,g=this.options,m=this.nodeAdapter,v=!1;function w(t){l.remove(),f._makeLeafIfNeeded(e),f._select(e,null,t),f._endEdit({action:"add",status:"cancel"})}function b(n,r){var a;v||(0!==n.length?(v=!0,m.addNode(d,o.children().length-1,n,s,(function(s,n){var h,u;if(!1===s)return v=!1,se(a=l.find(P).val(i).get(0)),void a.select();s?(l.remove(),u=t.htmlBuilder(),f._renderNode(s,p,u),n>=o.children("li").length?o.append(u.toString()):o.children("li").eq(n).before(u.toString()),h=o.children("li").eq(n),0===f.getSelection().length&&f._select(h.children(c),null,r),f._endEdit({action:"add",status:"complete"}),f._trigger("added",{},{parentNode:d,parent$:e,index:n,node:s,node$:h.children(c)})):w(r)}))):w(r))}function y(){var e,d,u,v=t.htmlBuilder(),y=f.baseId+"new";v.markup("<li").attr("id",y).attr("class",r+" "+S).markup("><div").attr("class",a+" "+_).markup("></div><div").attr("class",h+" "+_).markup(">"),m.getIcon&&v.markup("<span").attr("class",g.iconType).markup("></span>"),v.markup("<span role='treeitem'").attr("class",g.labelClass).attr(V,p).attr(E,K).markup("><input class='a-TreeView-input' type='text'></span></div></li>"),f._select(n(),null,!1),o.append(v.toString()),d=(l=o.find("#"+y)).children(c),e=1===f.rtlFactor?d.width()-d.find(f.labelSelector)[0].offsetLeft-16:d.find(f.labelSelector)[0].offsetLeft+d.find(f.labelSelector).width()-16,re(u=d.find(P),i,e,b,w),f._beginEdit({action:"add",context:s,input:u[0]})}if(!m.addNode||!m.allowAdd)throw U();if(null===e){if(d=m.root(),!g.showRoot){if(!m.allowAdd(d,"add",s?[s]:void 0))return;return p=1,o=u.find("ul:first"),void y()}e=u.find("ul:first > li")}else d=this.treeMap[Z(e.parent())];m.allowAdd(d,"add",s?[s]:void 0)&&(p=ee(e,f.labelSelector)+1,f._makeParentIfNeeded(e),this._expandNode(e.parent(),(function(){o=e.next("ul"),y()})))},renameNodeInPlace:function(e){var i,s,o,r,l,a,d=this,h=this.nodeAdapter,c=e.parent(),p=Z(c),f=!1,u=t.htmlBuilder();function g(t){a.selected=e.hasClass(_),u.clear(),ie(u,i,h,d.renderNodeOptions,a),e.html(u.toString()),a.selected&&d._select(e,null,t),d._endEdit({action:"rename",status:"cancel"})}if(!h.renameNode||!h.allowRename)throw U();i=this.treeMap[p],h.allowRename(i)&&(l=e.find(this.labelSelector),a={level:Y(l.attr(V)),selected:l.attr(E)===K,disabled:l.attr(M)===K,hasChildren:void 0!==l.attr(D),expanded:l.attr(D)===K},o=h.getLabel(i),r=1===d.rtlFactor?e.width()-l[0].offsetLeft-16:l[0].offsetLeft+l.width()-16,s=n("<input class='a-TreeView-input' type='text'>"),l.empty().append(s),re(s,o,r,(function(t,s){var n;f||(f=!0,t!==o&&0!==t.length?h.renameNode(i,t,(function(t,i){var r,l,m;if(!1===t)return f=!1,se(n=e.find(P).val(o)[0]),void n.select();t?(u.clear(),a.selected=e.hasClass(_),ie(u,t,h,d.renderNodeOptions,a),e.html(u.toString()),d.treeMap[p]=t,(r=(m=(l=c.parent()).children("li")).index(c))!==i&&(i>r&&(i+=1),i>=m.length?l.append(c):m.eq(i).before(c)),a.selected&&d._select(e,null,s),d._endEdit({action:"rename",status:"complete"}),d._trigger("renamed",{},{prevLabel:o,index:i,node:t,node$:e}),d._trigger(B,0)):g(s)})):g(s))}),g),d._beginEdit({action:"rename",node:i,input:s[0]}))},deleteNodes:function(e){var t,i,s,o=this,r=[],l=[],a=[],d=this.nodeAdapter;function h(e){var t=r[e];d.deleteNode(t.node,(function(e){s+=1,e&&(l.push(t.element),a.push({node:t.node,parent$:t.parent$,index:t.index}),d.clearViewId&&d.clearViewId(o.baseId,t.node)),s>=i&&(o.deleteTreeNodes(n(l)),o._trigger("deleted",{},{items:a}))}),e<i-1)}if(!d.deleteNode||!d.allowDelete)throw U();for(e.each((function(){var e=n(this),t=o.treeMap[Z(e.parent())];d.allowDelete(t)&&r.push({node:t,element:e[0],parent$:e.parent().parent().parent().children(c),index:Q(e.parent())})})),i=r.length,s=0,t=0;t<i;t++)h(t)},deleteTreeNodes:function(e){var t,i=this,s=e.closest("ul").prev(),n=e.parent(),o=e.children(this.labelSelector).filter(this.lastFocused).length>0,r=e.hasClass(_);(r||o)&&(0===(t=oe(n.eq(0))).length&&(t=this._getRoots().first()),t.length>0?r?this._select(t.children(c),null,o):this._setFocusable(t.children(c).find(this.labelSelector)):o&&(this.lastFocused=null)),n.remove().each((function(){delete i.treeMap[Z(n)]})),this._makeLeafIfNeeded(s)},addNode:function(e,t,i){var s,n,o=this.nodeAdapter;if(!o.addNode||!o.allowAdd)throw U();if(e&&e.length)n=this.treeMap[Z(e.parent())];else{if(this.options.showRoot)throw z();n=o.root()}o.allowAdd(n,"add",i?[i]:void 0)&&(s=this.element.find(".is-focused").length>0,this._add({},e,t,i,s))},moveNodes:function(e,t,i){var s,n,o,r=this.getNodes(i),l=!0,a=this.nodeAdapter;if(!a.moveNodes||!a.allowDelete||!a.allowAdd)throw U();if(e&&e.length)o=this.treeMap[Z(e.parent())];else{if(this.options.showRoot)throw z();o=a.root()}for(s=0;s<r.length;s++)if(!a.allowDelete(r[s])){l=!1;break}l&&a.allowAdd(o,"move",r)&&(n=this.element.find(".is-focused").length>0,this._moveOrCopy({},e,t,i,!1,n))},copyNodes:function(e,t,i){var s,n,o=this.getNodes(i),r=this.nodeAdapter;if(!r.copyNodes||!r.allowAdd)throw U();if(e&&e.length)n=this.treeMap[Z(e.parent())];else{if(this.options.showRoot)throw z();n=r.root()}r.allowAdd(n,"copy",o)&&(s=this.element.find(".is-focused").length>0,this._moveOrCopy({},e,t,i,!0,s))},update:function(e,i=!0){let s,n,o,r,l=!1,p=this.treeMap[Z(e.parent())],f=this.nodeAdapter,u=t.htmlBuilder();if(n=e.find(this.labelSelector),s=n[0]===this.lastFocused,f.getClasses||f.isDisabled||f.isHidden){let t,i=e.prevAll(d);G(e[0],[h,b,y,_,C]),G(i[0],[a,b,y,_,C]),f.getClasses&&(t=f.getClasses(p),t&&e.add(i).addClass(t)),f.isDisabled&&(r=f.isDisabled(p),e.add(i).toggleClass(b,r)),f.isHidden&&(l=f.isHidden(p),e.parent().toggleClass("u-hidden",l))}i&&(o={level:Y(n.attr(V)),selected:n.attr(E)===K,disabled:r,hasChildren:void 0!==n.attr(D),expanded:n.attr(D)===K},ie(u,p,f,this.renderNodeOptions,o),e.html(u.toString())),s&&(l&&(e=e.parent().parents("li").filter(T).first().children(c)),this._setFocusable(e.find(this.labelSelector)))},_copy:function(e){var t,i,s=this.nodeAdapter,n=this.getSelectedNodes(),o=this.options.dataTransferFormats;if(n.length){for(o.forEach((function(e){e.writer.begin(s,n)})),t=0;t<n.length;t++)i=n[t],o.forEach((function(e){e.writer.node(i,t,s.getLabel(i))}));o.forEach((function(t){t.writer.end(),e.setData(t.format,t.writer.toString())}))}},_parseTreeMarkup:function(e,t){var i,s,o,r=!0,l=this;return s=function e(t){var i=[];return t.children("ul").children("li").each((function(){var t,s,o,a,d,h,c=n(this),p=c.children("a").first(),f=c.children("span").first();t={},p.length>0?(t.label=p.text(),t.link=p.attr("href"),(h=p.attr("target"))&&(t.linkTarget=h)):f.length>0&&(t.label=f.text()),(o=c.attr("data-id"))?t.id=o:r=!1,c.attr("data-current")===K&&(t.current=!0,l.hasCurrent=!0),(a=c.attr("class"))&&(t.classes=a),c.attr("data-disabled")===K&&(t.isDisabled=!0),(s=c.attr("data-icon"))&&(t.icon=s),(d=c.attr("data-type"))&&(t.type=d),c.children("ul").length>0&&(t.children=e(c)),i.push(t)})),i}(e),o=s.length>=1?1===s.length&&this.options.showRoot?s[0]:{children:s}:null,t||(t={default:{operations:{canAdd:!1,canDelete:!1,canRename:!1,canDrag:!1}}}),i=n.apex.treeView.makeDefaultNodeAdapter(o,t,r),function(){return i}},_renderNode:function(e,t,i){let s,n,o,l,d,c,p,u=!1,g=!1,m=this.options,v=this.nodeAdapter;n=this.nextNodeId,this.treeMap[n]=e,v.setViewId&&v.setViewId(this.baseId,e,n),this.nextNodeId+=1,o=r+" ",s=v.hasChildren(e),null===s&&(g=!0,s=!0),s?(c=!1,v.isExpanded&&(c=v.isExpanded(this.baseId,e)),o+=c?N:x):o+=S,d=0===n&&m.showRoot&&!m.collapsibleRoot,d&&(o+=" a-TreeView--noCollapse"),1===t&&(o+=" a-TreeView-node--topLevel"),l=h,v.isDisabled&&v.isDisabled(e)&&(l+=" is-disabled",u=!0),v.isHidden&&v.isHidden(e)&&(o+=" u-hidden"),p=a;let _=this.baseId+n;if(i.markup("<li").attr("id",_).attr("role",L).attr("class",o).markup(">"),v.getClasses){let t=v.getClasses(e);t&&(l+=" "+t,p+=" "+t)}i.markup("<div").attr("role",L).attr("class",p).markup("></div>"),s&&!d&&i.markup("<span class='"+f+"'></span>"),i.markup("<div").attr("role",L).attr("class",l).markup(">"),ie(i,e,v,this.renderNodeOptions,{level:t,selected:!1,disabled:u,hasChildren:s,expanded:c}),i.markup("</div>"),c&&(i.markup(R),g?this._lazyExpand(_):this._renderChildren(e,t+1,i),i.markup(H)),i.markup("</li>")},_renderChildren:function(e,i,s,n,o){let r=this.nodeAdapter,l=r.childCount(e);const a=()=>{for(let t=0;t<l;t++)this._renderNode(r.child(e,t),i,s);n&&n(!0)};null===l?n&&(t.delayLinger.start(o[0].id,(function(){o.addClass(I)})),r.fetchChildNodes(e,(function(i){if(t.delayLinger.finish(o[0].id,(function(){o.removeClass(I),0===i&&n(i)})),i){if(l=r.childCount(e),l>0)return void a();i=0}!1===i&&n(i)}))):l>0?a():n&&n(0)},_getRoots:function(){return this.element.children("ul").children("li")},_find:function(e,t,i,s){var o,r,l,a=this,d=[];return e?(l=e.parent(),this._addChildrenIfNeeded(l),r=l.children("ul").children("li")):r=this._getRoots(),r.each((function(){if(o=a.treeMap[Z(n(this))],t(o)&&(d.push(n(this).children(c)[0]),!s))return!1})),(s||0===d.length)&&(i>1||-1===i)&&r.each((function(){if((d=d.concat(a._find(n(this).children(c),t,-1===i?i:i-1,s))).length>0&&!s)return!1})),d},_makeParentIfNeeded:function(e){e&&0===e.prev(u).length&&(e.parent().removeClass(S).addClass(x),e.before("<span class='"+f+"'></span>"),e.after("<ul role='group'></ul>"),e.parent().children("ul").hide())},_makeLeafIfNeeded:function(e){var t=this,i=this.nodeAdapter;e.each((function(){var e,s,o=n(this);0===o.next("ul").find("li").length&&((s=o.parent()).hasClass(N)&&i.setExpanded&&(e=t.treeMap[Z(s)],i.setExpanded(t.baseId,e,!1)),o.parent().removeClass("is-expandable is-collapsible").addClass(S),o.find(t.labelSelector).removeAttr(D),o.prev(u).remove(),o.next("ul").remove())}))},_addChildrenIfNeeded:function(e){var i,s=this.treeMap[Z(e)];e.children("ul").length>0||e.hasClass(S)||((i=t.htmlBuilder()).markup(R),this._renderChildren(s,J(e,this.labelSelector)+1,i),i.markup(H),e.append(i.toString()).children("ul").hide())},_toggleNode:function(e){e.hasClass(x)?this._expandNode(e):this._collapseNode(e)},_persistExpansionState:function(e,t,i){var s=this.nodeAdapter;s.setExpanded&&s.setExpanded(this.baseId,e,i),this._trigger("expansionStateChange",{},{node:e,nodeContent$:t.children(c),expanded:i})},_lazyExpand:function(e){this.lazyExpandQueue.push(e),this._delayExpand()},_expandNode:function(e,i){var s,o,r=this,l=this.nodeAdapter,a=this.treeMap[Z(e)];this.options.autoCollapse&&e.parent().children(".is-collapsible").each((function(){r._collapseNode(n(this))})),e.removeClass(x),(s=e.children("ul")).length>0&&null!==l.childCount(a)?(s.show(),e.addClass(N).children(c).find(this.labelSelector).attr(D,K),this._persistExpansionState(a,e,!0),i&&i()):(s.remove(),(o=t.htmlBuilder()).markup(R),this._renderChildren(a,J(e,this.labelSelector)+1,o,(function(t){t?(e.addClass(N).children(c).find(r.labelSelector).attr(D,K),o.markup(H),e.append(o.toString()),r._persistExpansionState(a,e,!0)):0===t?(e.children(u).remove(),e.addClass(S).children(c).find(r.labelSelector).removeAttr(D)):(e.addClass(x).children(c).find(r.labelSelector).attr(D,W),r._persistExpansionState(a,e,!1)),i&&i()}),e))},_collapseNode:function(e){var t=this.options;t.showRoot&&!t.collapsibleRoot&&e.parent().parent().hasClass(o)||(e.removeClass(N).addClass(x).children(c).find(this.labelSelector).attr(D,W),e.find(w).length>0&&this._select(e.children(c),null,!0),e.children("ul").hide(),this._persistExpansionState(this.treeMap[Z(e)],e,!1))},_traverseDown:function(e,t){if(this.lastFocused){let i=n(this.lastFocused).closest(l);for(let e=0;e<t;e++){let e=ne(i);if(0===e.length)break;i=e}i.length>0&&this._select(i.children(c),e,!0,!0)}},_traverseUp:function(e,t){if(this.lastFocused){let i=n(this.lastFocused).closest(l);for(let e=0;e<t;e++){let e=oe(i);if(0===e.length)break;i=e}i.length>0&&this._select(i.children(c),e,!0,!0)}},_activate:function(e,t){const n=this.options,o=this.nodeAdapter;let r,l,a=this.getSelectedNodes();if(0!==a.length&&(this._trigger("activateNode",e,{nodes:a}),n.navigation&&o.getLink&&!e.isDefaultPrevented()&&(r=o.getLink(a[0]),r)))if(r.startsWith($)){let n=s.parseActionBinding(r,!0);if(n){let o=n.contextId,r=this.actionsContext;o&&(r=s.findContextById(o),r||(i.error("No such context '"+o+"'"),r=null)),r&&r.invoke(n.actionName,e,t,n.args)}}else l=o.getLinkTarget&&o.getLinkTarget(a[0]),l?apex.navigation.openInNewWindow(r,l,{favorTabbedBrowsing:!0,noopener:!0}):apex.navigation.redirect(r)},_select:function(e,i,s,o,r){var a,h,p,f,u,g,m,y,C=e,N="set",I=this,S=this.element,k=S.find(c+w);if(i&&this.options.multiple&&("click"===i.type?i.ctrlKey||i.metaKey?N="toggle":i.shiftKey&&(N="range"):"keydown"===i.type&&(i.keyCode===n.ui.keyCode.SPACE?N=i.ctrlKey?"toggle":i.shiftKey?"range":"add":i.ctrlKey?N="none":i.shiftKey&&(N="range"))),"range"!==N||this.selectAnchor||(N="set"),"set"!==N&&"range"!==N||(k.prevAll(d).addBack().find(v).addBack().removeClass(_),k.find(this.labelSelector).attr(E,W)),h=e.eq(0).find(this.labelSelector),f=(e=e.not(".is-disabled")).hasClass(_),"set"===N||"add"===N||"toggle"===N&&!f)e.prevAll(d).addBack().find(v).addBack().addClass(_),e.find(this.labelSelector).attr(E,K),e.parent().parents(l).each((function(){(a=n(this)).hasClass(x)&&I._expandNode(a)})),this.selectAnchor=e[0];else if("range"===N){for(p=n("#"+this.selectAnchor.parentNode.id+", #"+C[0].parentNode.id),a=p.first();a.children(c).hasClass(b)||(a.children(c).prevAll(d).addBack().find(v).addBack().addClass(_),a.children(c).find(this.labelSelector).attr(E,K)),0!==(a=ne(a)).length&&1!==p.length&&a[0]!==p[1];);a.length>0&&2===p.length&&!a.children(c).hasClass(b)&&(a.children(c).prevAll(d).addBack().find(v).addBack().addClass(_),a.children(c).find(this.labelSelector).attr(E,K))}else"toggle"===N&&f&&(e.prevAll(d).addBack().find(v).addBack().removeClass(_),e.find(this.labelSelector).attr(E,W),this.selectAnchor=e[0]);h.length&&(s?se(h[0]):this._setFocusable(h),this.scrollParent&&(u=this.scrollParent[0],(y=h.parent().offset())&&(m=S.offset(),u===document?(g={top:n(document).scrollTop(),left:n(document).scrollLeft()},(y.top<g.top||y.top>g.top+n(window).height())&&n(document).scrollTop(y.top-m.top),(y.left+h.parent()[0].offsetWidth<g.left||y.left>g.left+n(window).width())&&n(document).scrollLeft(y.left-m.left)):(g=this.scrollParent.offset(),m=S.offset(),(y.top<g.top||y.top>g.top+u.offsetHeight)&&(u.scrollTop=y.top-m.top),(y.left+h.parent()[0].offsetWidth<g.left||y.left>g.left+u.offsetWidth)&&(u.scrollLeft=y.left-m.left))))),r||("toggle"===N||"range"===N&&!f||"add"===N&&!f||"set"===N&&!t.arrayEqual(k,e))&&(o?I._selNotifyLongDelay(i):I._selNotifyDelay(i))},_selChangeNotify:function(e){this.element.hasClass(o)&&this._trigger(B,e)},_setFocusable:function(e){var t=e[0];t&&(this.lastFocused&&this.lastFocused!==t&&(this.lastFocused.tabIndex=-1),t.tabIndex=0,this.lastFocused=t)},_beginEdit:function(e){this.editMode=!0,apex.tooltipManager&&apex.tooltipManager.disableTooltips(),this._trigger("beginEdit",{},e)},_endEdit:function(e){this.editMode=!1,apex.tooltipManager&&apex.tooltipManager.enableTooltips(),this._trigger("endEdit",{},e)},_mouseCapture:function(e,t){var i,s,o,r=!0,a=this.options;if(e.preventDefault(),this.animating||a.disabled||!a.dragAndDrop||n(e.target).hasClass(f))return!1;if(0===(s=n(e.target).closest(l).children(c)).length)return!1;if(a.dragMultiple&&(s.hasClass(_)?s=this.getSelection():e.ctrlKey&&(s=s.add(this.getSelection()))),!0!==t){for(o=this.getNodes(s),i=0;i<o.length;i++)if(!this.nodeAdapter.allowDrag||!this.nodeAdapter.allowDrag(o[i])){r=!1;break}if(!r)return!1}return this.dragItems=s,!0},_mouseStart:function(e,t,i){var s,o,r=null,l=this.options,a=this;return i||(n("body").on("keydown.treeview",(function(e){e.keyCode!==n.ui.keyCode.ESCAPE?a._dragCopyOrMove(e,!0):a._cancel(e)})).on("keyup.treeview",(function(e){a._dragCopyOrMove(e,!0)})),this._select(this.dragItems,null,!0,!1)),this.helper||(this.helper=this._createHelper(t)),this.margins={left:Y(this.dragItems.css("marginLeft"))||0,top:Y(this.dragItems.css("marginTop"))||0},this.offset=this.dragItems.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},j(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset()}),this.helper.css("position","absolute"),this._cacheHelperProportions(),n.ui.ddmanager&&!i&&(this.currentItem=this.dragItems.first(),n.ui.ddmanager.current=this,n.ui.ddmanager.prepareOffsets(this,e)),this.originalPosition=this._generatePosition(t),l.dragCursorAt&&this._adjustOffsetFromHelper(l.dragCursorAt),this.dragItems&&this.dragItems.length>0&&!this.isOver&&((r=this.getNodes(this.dragItems))[0]||(r=null)),this.nodeAdapter.dragOperations?this.dragOperations=this.nodeAdapter.dragOperations(r):this.dragOperations=r?{normal:"move",ctrl:"copy"}:{normal:"add"},this.dragOperation=this.dragOperations.normal,this.dragging=!0,this.lastHover&&(n(this.lastHover).children(p).removeClass(C),this.lastHover=null),l.dragReorder&&(o=this.dragItems.first().outerHeight(),"move"===this.dragOperation&&this.dragItems.parent().hide(),this._createPlaceholder(o),this.initialPlaceholderPos=null),this._initPositions(),this._refreshPositions(),l.dragContainment&&this._setContainment(),i||l.dragCursor&&"auto"!==l.dragCursor&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",l.dragCursor),this.storedStylesheet=n("<style>*{ cursor: "+l.dragCursor+" !important; }</style>").appendTo(s)),l.dragOpacity&&this.helper.css("opacity",l.dragOpacity),l.dragZIndex&&this.helper.css("zIndex",l.dragZIndex),this.helper.addClass("a-TreeView-dragHelper"),this.scrollParent&&this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset(),this.originalScroll={top:this.scrollParent[0].scrollTop,left:this.scrollParent[0].scrollLeft}),apex.tooltipManager&&apex.tooltipManager.disableTooltips(),this._trigger("start",t,this._uiHashDnD()),this._mouseDrag(t),n.ui.ddmanager&&!i&&n.ui.ddmanager.dragStart(this,t),!0},_mouseDrag:function(e){var t={pageX:e.pageX,pageY:e.pageY};return this.position=this._generatePosition(e),this.positionAbs=this._adjustPositionForScroll(),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.dragEventTarget=e.target,this.options.dragScroll&&(this._scrollCheck(t)?this.scrollTimerId||this._scrollStart(t):this.scrollTimerId&&this._scrollStop()),this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",this._dragCopyOrMove(e),this._dragHitCheck(),n.ui.ddmanager&&!this.isOver&&n.ui.ddmanager.drag(this,e),this._trigger("drag",e,this._uiHashDnD()),this.lastPositionAbs=this.positionAbs,!1},_dragHitCheck:function(){var e,t,i,s,o,r,l,a,h,p=this,f=0,u=null,m=this.dropTargetNode?this.dropTargetNode[0].id:null,v=this.options;if(this.scrollParent[0]!==document&&(f=this.scrollParent[0].scrollTop-this.dropPositionsOrigin),(i=this.positionAbs.left+this.offset.click.left)>this.containerCache.left&&i<this.containerCache.left+this.containerCache.width)if(this.placeholder&&n(this.dragEventTarget).closest("."+g).length)null===this.initialPlaceholderPos&&(this.initialPlaceholderPos=i),(a=(i-this.initialPlaceholderPos)*this.rtlFactor)>(this.options.dragScrollSensitivity||10)?(this.initialPlaceholderPos=i,this._movePlaceholder({element:this.placeholder.children(c)},"below")):a<(-this.options.dragScrollSensitivity||-10)&&(this.initialPlaceholderPos=i,this._movePlaceholder({element:this.placeholder.children(c)},"above"));else for(this.initialPlaceholderPos=null,s=this.positionAbs.top+this.offset.click.top+f,e=0;e<this.dropPositions.length;e++)if(s>=(t=this.dropPositions[e]).top&&s<=t.bottom){u=t.nodeId,r=s>t.top+(t.bottom-t.top)/2?"bottom":"top";break}m===u&&r===this.lastLocation||(p.delayExpandTimer&&(clearTimeout(p.delayExpandTimer),p.delayExpandTimer=null),this.element.find(".is-active").removeClass(O),u?(o=n("#"+u),v.dragExpandDelay>=0&&o.hasClass(x)&&(this.delayExpandTimer=setTimeout((function(){p.delayExpandTimer=null,p._expandNode(o,(function(){p._initPositions(o),p._refreshPositions()}))}),v.dragExpandDelay)),t.canAdd?(this.dropTargetNode=o,this.placeholder?(l=0!==(h=p.positionAbs.top-p.lastPositionAbs.top)&&(h>0?"down":"up"),"top"===r&&"up"===l?this._movePlaceholder(t,"before"):"bottom"===r&&"down"===l&&(t.canAddChild?(this.initialPlaceholderPos=i,this._movePlaceholder(t,"after"),this._movePlaceholder({element:this.placeholder.children(c)},"below")):this._movePlaceholder(t,"after"))):this.dropTargetNode.children(c+","+d).addClass(O)):t.canAddChild&&this.placeholder&&(this.initialPlaceholderPos=i,this._movePlaceholder(t,"after"),this._movePlaceholder({element:this.placeholder.children(c)},"below"))):this.dropTargetNode=null),this.lastLocation=r},_mouseStop:function(e,t){var i,s=this;return this.delayExpandTimer&&(clearTimeout(this.delayExpandTimer),this.delayExpandTimer=null),this._scrollStop(),n.ui.ddmanager&&!t&&n.ui.ddmanager.dragStop(this,e),t||n("body").off(".treeview"),this._deactivate(),this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),n.ui.ddmanager&&!t&&n.ui.ddmanager.drop(this,e)?(this.placeholder&&(this.dragItems.parent().show(),this._removePlaceholder()),this.dragging=!1,this.dragItems=null,this.currentItem=null,this.helper.remove(),this.helper=null,void this._stop(e)):e.target?void(this.options.dragAnimate?(i=this._getAnimation(),this.animating=!0,this.helper.animate(i,Y(this.options.dragAnimate)||500,(function(){s._finishDrag(e)}))):this._finishDrag(e)):(this.fromOutside=!1,void(this.dragging=!1))},_scrollCheck:function(e,t){var i,s,o,r=0,l=0,a=this.options,d=this.scrollParent[0];return d&&d!==document&&"HTML"!==d.tagName?(this.overflowOffset.top+d.offsetHeight-e.pageY<a.dragScrollSensitivity?r=a.dragScrollSpeed:e.pageY-this.overflowOffset.top<a.dragScrollSensitivity&&(r=-a.dragScrollSpeed),t&&r&&((i=d.scrollTop+r)<0?(d.scrollTop=0,r=0):i>d.scrollHeight-d.clientHeight?(d.scrollTop=d.scrollHeight-d.clientHeight,r=0):d.scrollTop=i),this.overflowOffset.left+d.offsetWidth-e.pageX<a.dragScrollSensitivity?l=a.dragScrollSpeed:e.pageX-this.overflowOffset.left<a.dragScrollSensitivity&&(l=-a.dragScrollSpeed),t&&l&&((s=d.scrollLeft+l)<0?(d.scrollLeft=0,l=0):s>d.scrollWidth-d.clientWidth?(d.scrollLeft=d.scrollWidth-d.clientWidth,l=0):d.scrollLeft=s),o=!(!l&&!r)):(i=n(document).scrollTop(),s=n(document).scrollLeft(),e.pageY-i<a.dragScrollSensitivity?r=-a.dragScrollSpeed:n(window).height()-(e.pageY-i)<a.dragScrollSensitivity&&(r=a.dragScrollSpeed),t&&r&&((i+=r)<0?(n(document).scrollTop(0),r=0):i>n(document).height()-n(window).height()?(n(document).scrollTop(n(document).height()-n(window).height()),r=0):(e.pageY+=r,n(document).scrollTop(i))),e.pageX-s<a.dragScrollSensitivity?l=-a.dragScrollSpeed:n(window).width()-(e.pageX-s)<a.dragScrollSensitivity&&(l=a.dragScrollSpeed),t&&l&&((s+=l)<0?(n(document).scrollLeft(0),l=0):s+this.helper.width()>n(document).width()-n(window).width()?(n(document).scrollLeft(n(document).width()-n(window).width()-this.helper.width()),l=0):(e.pageX+=l,n(document).scrollLeft(s))),(o=!(!l&&!r))&&t&&(this.position=this._generatePosition(e),this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",n.ui.ddmanager&&n.ui.ddmanager.prepareOffsets(this,e))),o},_scrollStart:function(e){var t=this,i=0,s=[150,125,100,99,96,91,84,75,64,51,36];this.scrollTimerId&&this._scrollStop(),function n(){t.scrollTimerId=setTimeout((function(){t._scrollCheck(e,!0)?(t._dragHitCheck(),n()):t._scrollStop()}),s[i]),i<s.length-1&&(i+=1)}()},_scrollStop:function(){clearTimeout(this.scrollTimerId),this.scrollTimerId=null},_getAnimation:function(){var e,t,i={};return this.placeholder||this.dropTargetNode?(e=this.placeholder?(t=this.placeholder).offset():(t=this.dropTargetNode).offset(),i.left=e.left-this.offset.parent.left-this.margins.left,i.top=e.top-this.offset.parent.top-this.margins.top):(t=this.dragItems.eq(0),e=this.originalPosition,i.left=e.left-this.margins.left,i.top=e.top-this.margins.top,this.scrollParent[0]!==document&&(i.left+=this.originalScroll.left-this.scrollParent[0].scrollLeft,i.top+=this.originalScroll.top-this.scrollParent[0].scrollTop)),-1===this.rtlFactor&&(i.left+=t.width()-this.helper.width()),i},_initPositions:function(e){var t,i,s,o,r,a=this,h=[],c=this.options.dragReorder,p=this.nodeAdapter;if(this.dragItems&&this.dragItems.length>0&&(r=this.getNodes(this.dragItems))[0]||(r=[]),e&&this.dropPositions)for(i=[],o=e[0].id,s=0;s<this.dropPositions.length&&o!==this.dropPositions[s].nodeId;s++);else i=this.dropPositions=[],e=this.element;if(e.find(l).each((function(){var e,t,s,o=!1,f=n(this);f.is(T)&&!f.is("."+g)&&(e=c?(t=f.parent().closest(l)).length?a.treeMap[Z(t)]:a.options.showRoot?null:p.root():a.treeMap[Z(f)],c||"move"!==a.dragOperation||!r.includes(e)&&!h.includes(f.parent().closest(l)[0])?(s=e&&p.allowAdd(e,a.dragOperation,r),c&&(o=p.allowAdd(a.treeMap[Z(f)],a.dragOperation,r)),(s||o||f.hasClass(x))&&i.push({canAdd:s,canAddChild:o,element:n(this).children(d),nodeId:this.id,top:0,bottom:0})):h.push(this))})),void 0!==s&&i.length)for(t=0;t<i.length;t++)this.dropPositions.splice(s+t,0,i[t])},_refreshPositions:function(){var e,t,i,s,n;for(e=0;e<this.dropPositions.length;e++)s=(t=this.dropPositions[e]).element.outerHeight(),i=t.element.offset(),t.top=i.top,t.bottom=i.top+s;this.dropPositionsOrigin=0,(n=this.scrollParent)&&n[0]!==document?this.dropPositionsOrigin=n[0].scrollTop:n=this.element,i=n.offset(),this.containerCache.left=i.left,this.containerCache.top=i.top,this.containerCache.width=n.outerWidth(),this.containerCache.height=n.outerHeight()},_makeTempDragItem:function(){var e,i,s,o=t.htmlBuilder();for(o.markup("<li").attr("class",r).markup("><div").attr("class",a).markup("></div><div").attr("class",h).markup(">unseen content</div></li>"),i=n(o.toString()),e=0;e<this.dropPositions.length;e++)if(this.dropPositions[e].canAdd){s=n(this.dropPositions[e].nodeId).parent();break}s||(s=this.element.children("ul")),s.append(i),this.dragItems=i.children(c)},_createPlaceholder:function(e){this.placeholder=n("<li class='"+r+" "+g+"'><div class='"+a+"'></div><div class='"+h+"'>&nbsp;</div></li>"),this.dragItems.first().parent().before(this.placeholder),e&&this.placeholder.height(e)},_movePlaceholder:function(e,t){var i,s,r,a,d,h=this,p=this.placeholder.parent(),f=this.nodeAdapter,u=e.element.parent(),g=u[0];if("after"===t&&u.hasClass(N)&&f.allowAdd(h.treeMap[Z(u)],h.dragOperation)&&(g=u.children("ul").children()[0],t="before"),"above"===t){if(u.next(T).length)return;if(g=u.parent().parent()[0],d=(s=(u=n(g)).parent().closest(l)).length?h.treeMap[Z(s)]:h.options.showRoot?null:f.root(),u.hasClass(o)||null===d)return;if(!(r=f.allowAdd(d,h.dragOperation)))return;t="after"}if("below"===t){if(a=!1,(i=u.prevAll(T).first()).hasClass(N)&&(i=i.children("ul").children().last(),a=!0),0===i.length)return;if(r=f.allowAdd(h.treeMap[Z(i)],h.dragOperation),!a&&i.hasClass(S)&&r&&this._makeParentIfNeeded(i.children(c)),i.hasClass(x))return void this._expandNode(i,(function(){h._initPositions(i),h._refreshPositions(),r&&i.children("ul")[0].appendChild(h.placeholder[0])}));r&&i[0].parentNode.appendChild(this.placeholder[0])}else"after"!==t||g.nextSibling?g.parentNode.insertBefore(this.placeholder[0],"before"===t?g:g.nextSibling):g.parentNode.appendChild(this.placeholder[0]);0===p.children().length&&this._makeLeafIfNeeded(p.parent().find(c)),this._refreshPositions()},_removePlaceholder:function(){var e=this.placeholder.parent();this.placeholder.remove(),this.placeholder=null,0===e.children().length&&this._makeLeafIfNeeded(e.parent().find(c))},_createHelper:function(e){var t,i=this.options;return n.isFunction(i.dragHelper)?t=n(i.dragHelper.apply(this.element[0],[e,this.dragItems])):1===this.dragItems.length?t=this.dragItems.clone().removeAttr("id").removeClass(_):(t=n("<div></div>")).html(this.dragItems.clone().removeClass(_)),t.parents("body").length||t.appendTo("parent"===i.dragAppendTo?this.element[0].parentNode:i.dragAppendTo),/(fixed|absolute)/.test(t.css("position"))||t.css("position","absolute"),t},_adjustOffsetFromHelper:function(e){"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){var e;return this.offsetParent=this.helper.offsetParent(),e=this.offsetParent[0]===document||this.offsetParent[0]===document.firstElementChild?{left:0,top:0}:this.offsetParent.offset(),this.scrollParent&&this.scrollParent[0]!==document&&n.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&n.ui.ie)&&(e={top:0,left:0}),{top:e.top+(Y(this.offsetParent.css("borderTopWidth"))||0),left:e.left+(Y(this.offsetParent.css("borderLeftWidth"))||0)}},_generatePosition:function(e){var t=e.pageX,i=e.pageY,s=this.scrollParent&&this.scrollParent[0]!==document&&n.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(s[0].tagName);return this.dragging||this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(t=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(i=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(t=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(i=this.containment[3]+this.offset.click.top)),{top:i-this.offset.click.top-this.offset.parent.top+(o?0:s.scrollTop()),left:t-this.offset.click.left-this.offset.parent.left+(o?0:s.scrollLeft())}},_adjustPositionForScroll:function(){var e=this.position,t=this.scrollParent&&this.scrollParent[0]!==document&&n.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(t[0].tagName);return{top:e.top+this.offset.parent.top-(i?0:t.scrollTop()),left:e.left+this.offset.parent.left-(i?0:t.scrollLeft())}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,s=this.options;"parent"===s.dragContainment&&(s.dragContainment=this.helper[0].parentNode),"document"!==s.dragContainment&&"window"!==s.dragContainment||(this.containment=[0-this.offset.parent.left,0-this.offset.parent.top,n("document"===s.dragContainment?document:window).width()-this.helperProportions.width-this.margins.left,(n("document"===s.dragContainment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(s.dragContainment)||(e=n(s.dragContainment)[0],t=n(s.dragContainment).offset(),i="hidden"!==n(e).css("overflow"),this.containment=[t.left+(Y(n(e).css("borderLeftWidth"))||0)+(Y(n(e).css("paddingLeft"))||0)-this.margins.left,t.top+(Y(n(e).css("borderTopWidth"))||0)+(Y(n(e).css("paddingTop"))||0)-this.margins.top,t.left+(i?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(Y(n(e).css("borderLeftWidth"))||0)-(Y(n(e).css("paddingRight"))||0)-this.helperProportions.width-this.margins.left,t.top+(i?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(Y(n(e).css("borderTopWidth"))||0)-(Y(n(e).css("paddingBottom"))||0)-this.helperProportions.height-this.margins.top])},_intersectsWith:function(e){var t=this.positionAbs.left,i=this.positionAbs.top,s=e.left,n=s+e.width,o=e.top,r=o+e.height,l=this.offset.click.top,a=this.offset.click.left;return i+l>o&&i+l<r&&(t+a>s&&t+a<n)},_dragCopyOrMove:function(e,t){var i,s;e.ctrlKey?i="ctrl":e.altKey?i="alt":e.shiftKey?i="shift":e.metaKey&&(i="meta"),s=this.dragOperations[i]||this.dragOperations.normal,this.dragOperation!==s&&(this.dragOperation=s,this.placeholder&&this.dragItems.parent().toggle("move"!==s),this._initPositions(),this._refreshPositions(),t&&this._trigger("drag",e,this._uiHashDnD()))},_cancel:function(e,t){var i,s=this;function o(){s.animating=!1,s.helper&&s.helper[0].parentNode&&s.helper.remove(),s.helper=null,s.dragging=!1,s.dragItems=null,s.currentItem=null,s._stop(e)}this.dragging&&(this.positionAbs.top=-99999,this._mouseUp(n.Event("mouseup",{target:null})),this.placeholder&&this.dragItems.parent().show()),this.dropTargetNode=null,this.placeholder&&this._removePlaceholder(),this.options.dragAnimate&&!t?(i=this._getAnimation(),this.animating=!0,this.helper.animate(i,Y(this.options.dragAnimate)||500,(function(){o()}))):o()},_deactivate:function(){this.element.find(".is-active").removeClass(O)},_finishDrag:function(e){var t,s,n,o,r,a=!0,d=this.nodeAdapter;if(this.animating=!1,this.placeholder?(s=this.placeholder.parent().closest(l),this.dragItems.parent().show(),n=Q(this.placeholder),"move"===this.dragOperation&&this.dragItems.parent().hide()):(s=this.dropTargetNode,n=0),this.fromOutside){if(this.dragItems.parent().remove(),"add"===this.dragOperation&&d.addNode)try{this.placeholder&&this._removePlaceholder(),this._add(e,s.children(c),n,null,!0)}catch(e){i.error("Error in drop add action.",e)}}else if(("copy"===this.dragOperation||"move"===this.dragOperation)&&d.allowAdd&&d["copy"===this.dragOperation?"copyNodes":"moveNodes"]&&("copy"===this.dragOperation||d.allowDelete))try{if("object"==typeof s&&null!==s){if(o=s.length||this.options.showRoot?this.treeMap[Z(s)]:d.root(),d.allowAdd(o,this.dragOperation,this.dragItems)&&"move"===this.dragOperation)for(r=this.getNodes(this.dragItems),t=0;t<r.length;t++)if(!d.allowDelete(r[t])){a=!1;break}if(a&&"move"===this.dragOperation)if(this.placeholder){if(this.dragItems.last().closest(l).next()[0]===this.placeholder[0]){for(a=!1,t=0;t<this.dragItems.length-1;t++)if(this.dragItems.eq(t).closest(l).next()[0]!==this.dragItems.eq(t+1).closest(l)[0]){a=!0;break}}else if(this.dragItems.first().closest(l).prev()[0]===this.placeholder[0])for(a=!1,t=1;t<this.dragItems.length;t++)if(this.dragItems.eq(t).closest(l).prev()[0]!==this.dragItems.eq(t-1).closest(l)[0]){a=!0;break}}else for(a=!1,t=0;t<this.dragItems.length;t++)if(this.dragItems.eq(t).closest(l).parent().closest(l)[0]!==s[0]){a=!0;break}a?(this.placeholder&&this._removePlaceholder(),this._moveOrCopy(e,s.children(c),n,this.dragItems,"copy"===this.dragOperation,!0)):this.dragItems.parent().show()}}catch(e){this.dragItems.parent().show(),i.error("Error in drop "+this.dragOperation+" action.",e)}this.dragging=!1,this._trigger("beforeStop",e,this._uiHashDnD()),this.dragItems=null,this.currentItem=null,this.placeholder&&this._removePlaceholder(),this.helper.remove(),this.helper=null,this.fromOutside&&this._trigger("deactivate",e,this._uiHashDnD(this)),this._stop(e),this.fromOutside=!1},_stop:function(e){apex.tooltipManager&&apex.tooltipManager.enableTooltips(),this._trigger("stop",e,this._uiHashDnD())},_add:function(e,i,s,o,r){var l,a,d=this,h=this.nodeAdapter;i&&i.length?(l=this.treeMap[Z(i.parent())],a=ee(i,this.labelSelector)+1):(i=null,l=h.root(),a=1),h.addNode(l,s,null,o,(function(o,h){var p,f,u,g=t.htmlBuilder(),m={parentNode:l,parent$:i,node:o,index:h};function v(){d._select(m.node$,e,r),d._trigger("added",e,m)}if(!(!1===o||null===o||h<0)){if(i){if(d._makeParentIfNeeded(i),0===(f=i.parent().children("ul")).length)return void d._expandNode(i.parent(),(function(){f=i.parent().children("ul"),m.node$=f.children().eq(s).children(c),v()}))}else f=d.element.children("ul");d._renderNode(o,a,g),p=n(g.toString()),m.node$=p.children(c),h>=(u=f.children()).length?f.append(p):u.eq(h).before(p),v()}}))},_moveOrCopy:function(e,i,s,o,r,a){var d,h,p=this,f=this.getNodes(o),u=r?"copyNodes":"moveNodes",g=this.nodeAdapter;i&&i.length?(d=this.treeMap[Z(i.parent())],h=ee(i,this.labelSelector)+1):(i=null,d=g.root(),h=1),g[u](d,s,f,(function(s){var f,u,m,v,_,w,b,y,C=t.htmlBuilder(),x=[],N=[],I={parentNode:d,parent$:i,items:x};function S(){for(f=0;f<x.length;f++)w=x[f],m=g.child(d,w.toIndex),w.toNode=m,C.clear(),p._renderNode(m,h,C),v=n(C.toString()),w.toNode$=v.children(c),y=b.children(T),w.toIndex>=y.length?b.append(v):y.eq(w.toIndex).before(v),N.push(w.toNode$[0]),r||(_=w.fromNode$.parent().parent().closest(l).children(c),w.fromParent$=_,w.fromIndex=w.fromNode$.parent().parent().children().index(w.fromNode$.parent()),w.fromNode$.parent().remove(),p._makeLeafIfNeeded(_));p._select(n(N),e,a),p._trigger(r?"copied":"moved",e,I)}if(s){for(f=0;f<s.length;f++)(u=s[f])>=0&&x.push({fromNode$:o.eq(f),toIndex:u});if(x.sort((function(e,t){return e.toIndex-t.toIndex})),i)return p._makeParentIfNeeded(i),b=i.parent().children("ul"),void p._expandNode(i.parent(),(function(){S()}));b=p.element.children("ul"),S()}}))},_uiHashDnD:function(e){var t=e||this;return{helper:t.helper,placeholder:t.dropTargetNode||t.placeholder||n([]),position:t.position,originalPosition:t.originalPosition,offset:t.positionAbs,items:t.dragItems,operation:t.dragOperation,sender:e?e.element:null}}},apex.widget.contextMenuMixin));const ae={root:function(){return this.data},getLabel:function(e){return e.label},getIcon:function(e){var t=this.getType(e),i=null;return e.icon||null===e.icon?i=e.icon:t.icon||null===t.icon?i=t.icon:void 0!==this.types.default.icon&&(i=this.types.default.icon),i},getClasses:function(e){let t=this.getType(e),i=null;return t.classes?i=t.classes:this.types.default.classes&&(i=this.types.default.classes),e.classes&&(i?i+=" "+e.classes:i=e.classes),i},getLink:function(e){return e.link},getLinkTarget:function(e){return e.linkTarget},isDisabled:function(e){let t=this.getType(e),i=!1;return void 0!==e.isDisabled?i=e.isDisabled:void 0!==t.isDisabled?i=t.isDisabled:void 0!==this.types.default.isDisabled&&(i=this.types.default.isDisabled),i},child:function(e,t){if(e.children)return e.children[t]},childCount:function(e){return e.children?e.children.length:0},hasChildren:function(e){return!!e.children&&e.children.length>0},allowAdd:function(e,t,i){let s,o=this.getType(e),r=!!e.children&&this.check("canAdd",e,t,i);if(r&&i)if(n.isFunction(o.validChildren))r=o.validChildren(e,i);else if(void 0!==o.validChildren?s=o.validChildren:void 0!==this.types.default.validChildren&&(s=this.types.default.validChildren),!0!==s)for(let e=0;e<i.length;e++)if(!s.includes(i[e].type)){r=!1;break}return r},allowRename:function(e){return this.check("canRename",e)},allowDelete:function(e){return e!==this.data&&this.check("canDelete",e)},allowDrag:function(e){return this.check("canDrag",e)},dragOperations:function(e){var t,i,s;if(e){if(e.length>0){for(s=e[0].type||"default",t=1;t<e.length;t++)if(e[t].type!==s){s="default";break}}else s="default";i=this.types[s].operations&&void 0!==this.types[s].operations.drag?this.types[s].operations.drag:this.types.default.operations.drag}else i=this.types.default.operations.externalDrag;return i},addNode:function(e,t,i,s,n){var o,r=j(!0,{},s||this.newNode(e));i&&(r.label=i),this.sortCompare?e.children.push(r):e.children.splice(t,0,r),r._parent=e,void 0!==this._nextId&&(void 0===r.id?r.id=this.nextId():this._nextId+=1),this.sortCompare&&e.children.sort(this.sortCompare),o=e.children.indexOf(r),this.validateAdd(r,o,(function(t){"string"==typeof t||!1===t?(e.children.splice(o,1),n(!1===t&&null)):t&&n(r,o)}))},renameNode:function(e,t,i){var s,n=e.label;e.label=t,e._parent?(this.sortCompare&&e._parent.children.sort(this.sortCompare),s=e._parent.children.indexOf(e)):s=0,this.validateRename(e,s,(function(t){"string"==typeof t||!1===t?(e.label=n,i(!1===t&&null)):t&&i(e,s)}))},deleteNode:function(e,t,i){var s=e._parent,n=e._parent.children.indexOf(e);s.children.splice(n,1),delete e._parent,this.validateDelete(e,i,(function(i){i||(e._parent=s,s.children.splice(n,0,e)),t(i)}))},moveNodes:function(e,t,i,s){var n,o,r,l,a=[];for(n=0;n<i.length;n++)l=(r=(o=i[n])._parent).children.indexOf(o),r.children.splice(l,1),e===r&&l<t&&(t-=1),this.sortCompare?e.children.push(o):(e.children.splice(t,0,o),t+=1),o._parent=e;for(this.sortCompare&&e.children.sort(this.sortCompare),n=0;n<i.length;n++)a[n]=e.children.indexOf(i[n]);this.validateMove(e,i,a,(function(e){s(!!e&&a)}))},copyNodes:function(e,t,i,s){var n,o,r=this,l=[],a=[];function d(e,t){var i,s=j({},e);if(s._parent=t,void 0!==r._nextId&&(s.id=r.nextId()),e.children)for(s.children=[],i=0;i<e.children.length;i++)s.children.push(d(e.children[i],s));return s}for(n=0;n<i.length;n++)o=d(i[n],e),l[n]=o,this.sortCompare?e.children.push(o):(e.children.splice(t,0,o),a[n]=t,t+=1);if(this.sortCompare)for(e.children.sort(this.sortCompare),n=0;n<l.length;n++)a[n]=e.children.indexOf(l[n]);this.validateCopy(e,l,a,(function(e){s(!!e&&a)}))},sortCompare:function(e,t){return e.label>t.label?1:e.label<t.label?-1:0},nextId:function(){var e=this._nextId;return this._nextId+=1,"tn"+e},newNode:function(e){var t,i={},s=!0,n=this.getType(e);return void 0!==this._nextId&&(i.id=this.nextId()),Array.isArray(n.validChildren)?(i.type=n.validChildren[0],(t=this.types[i.type])&&t.operations&&void 0!==t.operations.canAdd?s=n.operations.canAdd:void 0!==this.types.default.operations.canAdd&&(s=this.types.default.operations.canAdd),t&&void 0!==t.defaultLabel?i.label=t.defaultLabel:void 0!==this.types.default.defaultLabel&&(i.label=this.types.default.defaultLabel)):void 0!==this.types.default.defaultLabel&&(i.label=this.types.default.defaultLabel),s&&(i.children=[]),i},extraCheck:function(e){return e},validateAdd:function(e,t,i){i(!0)},validateRename:function(e,t,i){i(!0)},validateDelete:function(e,t,i){i(!0)},validateMove:function(e,t,i,s){s(!0)},validateCopy:function(e,t,i,s){s(!0)},getType:function(e){var t="default";return e.type&&(t=e.type),this.types[t]||this.types.default},check:function(e,t,i,s){var o=!1,r=this.getType(t);return t.operations&&void 0!==t.operations[e]?o=t.operations[e]:r.operations&&void 0!==r.operations[e]?o=r.operations[e]:void 0!==this.types.default.operations[e]&&(o=this.types.default.operations[e]),n.isFunction(o)&&(o=o.call(this,t,i,s)),this.extraCheck(o,e,t,i,s)}};if(n.apex.treeView.makeDefaultNodeAdapter=function(e,t,i,s){let o=Object.create(ae);return Array.isArray(i)&&(s=i,i=!0),null==i&&(i=!0),i&&(n.apex.treeView.addViewStateMixin(o,"id",s),o._nextId=1),o.data=e,o.types=j(!0,{},{default:{isDisabled:!1,validChildren:!0,operations:{canAdd:!0,canRename:!0,canDelete:!0,canDrag:!0,drag:{normal:"move",ctrl:"copy"},externalDrag:{normal:"add"}}}},t),o.data&&function e(t,s){if(t._parent=s,i&&(o._nextId+=1),t.children)for(let i=0;i<t.children.length;i++)e(t.children[i],t)}(o.data,null),o},n.apex.treeView.makeModelNodeAdapter=function(e,t,i){let s,o;if(!apex.model)throw new Error("Missing module apex.model");return t.shape="tree",s=apex.model.create(e,t,i),o=t.labelField||"label",s._labelKey=s.getFieldKey(o),t.hasIdentity&&n.apex.treeView.addViewStateMixin(s,(function(e){return s.getRecordId(e)}),t.initialExpandedNodeIds),(!i||t.editable||t.visibilityFilter)&&(s.setView=function(t){n.apex.treeView.treeModelListener(e,t)}),s.getType=s._getType,s.getLabel=function(e){return e[this._labelKey]},(t.iconField||t.typeField)&&(t.iconField&&(s._iconKey=s.getFieldKey(t.iconField)),s.getIcon=function(e){let t=this.getType(e),i=this._options,s=null;return this._iconKey&&(e[this._iconKey]||null===e[this._iconKey])?s=e[this._iconKey]:t.icon||null===t.icon?s=t.icon:void 0!==i.types.default.icon&&(s=i.types.default.icon),s}),(t.classesField||t.typeField)&&(t.classesField&&(s._classesKey=s.getFieldKey(t.classesField)),s.getClasses=function(e){let t=this.getType(e),i=this._options,s=null;return t.classes?s=t.classes:i.types.default.classes&&(s=i.types.default.classes),this._classesKey&&e[this._classesKey]&&(s?s+=" "+e[this._classesKey]:s=e[this._classesKey]),s}),s.isHidden=function(e){let t=!1,i=this.getRecordMetadata(this.getRecordId(e));return i&&i.hidden&&(t=!0),t},t.linkField&&(s._linkKey=s.getFieldKey(t.linkField),s.getLink=function(e){return this._linkKey?e[this._linkKey]:null}),t.linkTargetField&&(s._linkTargetKey=s.getFieldKey(t.linkTargetField),s.getLinkTarget=function(e){return this._linkTargetKey?e[this._linkTargetKey]:null}),s.allowRename=s.allowEdit,s.addNode=function(e,t,i,s,n){let o,r,l,a=null,d=this._initRecord(s,null,e);r=e[this._childrenKey],t>=0&&t<r.length&&(a=r[t]),i&&(d[this._labelKey]=i),l=this.insertNewRecord(e,a,d),d=this.getRecord(l),o=r.indexOf(d),n(d,o)},s.renameNode=function(e,t,i){let s,n;this.setValue(e,o,t),n=this.parent(e),s=n?n[this._childrenKey].indexOf(e):0,i(e,s)},s.deleteNode=function(e,t){t(1===this.deleteRecords([e]))},s.moveNodes=function(e,t,i,s){let n,o=[],r=null,l=e[this._childrenKey];(t-=1)>=0&&t<l.length&&(r=l[t]),n=this.moveRecords(i,e,r);for(let e=0;e<n.length;e++){let t=this.getRecord(n[e]);o[e]=l.indexOf(t)}s(o)},s.copyNodes=function(e,t,i,s){let n,o=[],r=null,l=e[this._childrenKey];(t-=1)>=0&&t<l.length&&(r=l[t]),n=this.copyRecords(i,e,r);for(let e=0;e<n.length;e++){let t=this.getRecord(n[e]);o[e]=l.indexOf(t)}s(o)},s},n.apex.treeView.treeModelListener=function(e,t){let i,s=t.data("apex-treeView"),o=s.getNodeAdapter();if(i=s.option("treeModel"),i){i.unSubscribe(s.option("modelViewId"));let t=s.option("modelId");t!==e&&apex.model.release(t),s.option("modelId",null),s.option("treeModel",null),s.option("modelViewId",null)}if(e){if(i=apex.model.get(e),!i)throw new Error("TreeView model not found: "+e);s.option("modelId",e),s.option("treeModel",i),s.option("modelViewId",i.subscribe({onChange:function(e,t){let i;function r(e){let t=[];for(let i=0;i<e.length;i++){let r=o.getViewId(s.baseId,e[i]);r&&t.push(n("#"+s.baseId+r).children(c)[0])}return n(t)}if("refresh"===e)s.refresh();else if("addData"===e)null===t.parentNode&&s.refresh();else if("refreshRecords"===e||"revert"===e);else if("move"===e);else if("copy"===e);else if("insert"===e)i=r([o.parent(t.record)]),s.refresh(i);else if("clearChanges"===e);else if("delete"===e){i=r(t.records);for(let e=0;e<t.records.length;e++)o.clearViewId(s.baseId,t.records[e]);s.deleteTreeNodes(i)}else if(("set"===e||"metaChange"===e)&&(i=r([t.record]),i[0])){let n="metaChange"===e&&"hidden"===t.property||"set"===e&&t.field===o._options.classesField;s.update(i,!n)}},progressView:s.element}))}},n.apex.treeView.addViewStateMixin=function(e,t,i){j(e,{_state:{},isExpanded:function(e,t){return this._getExpandedNodes(e)[this._getIdentity(t)]||!1},setExpanded:function(e,t,i){this._getExpandedNodes(e)[this._getIdentity(t)]=i},getExpandedNodeIds:function(e){var t,i=[],s=this._getExpandedNodes(e);for(t in s)X(s,t)&&!0===s[t]&&i.push(t);return i},getExpandedState:function(e){var t=this._getExpandedNodes(e);return j({},t)},getViewId:function(e,t){var i=this._state[e]&&this._state[e].nodeMap;return i&&i[this._getIdentity(t)]},setViewId:function(e,t,i){var s=this._state[e]&&this._state[e].nodeMap;s||(s={},this._state[e]||(this._state[e]={}),this._state[e].nodeMap=s),s[this._getIdentity(t)]=i},clearViewId:function(e,t){var s=this._state[e]&&this._state[e].nodeMap,n=this._state[e]&&this._state[e].expandedNodes;s&&(t?(delete s[this._getIdentity(t)],n&&delete n[this._getIdentity(t)]):(i=this.getExpandedNodeIds(e),this._state[e].nodeMap={},delete this._state[e].expandedNodes))},_getExpandedNodes:function(e){let t=this._state[e]&&this._state[e].expandedNodes;if(!t&&(this._state[e]||(this._state[e]={}),t={},this._state[e].expandedNodes=t,i))for(let e=0;e<i.length;e++)t[i[e]]=!0;return t}}),e._getIdentity||(e._getIdentity=n.isFunction(t)?t:function(e){return e[t]})},n.ui.draggable&&(n.ui.plugin.add("draggable","connectToTreeView",{start:function(e,t){var s=n(this).data("ui-draggable"),o=s.options,r=j({},t,{item:s.element});n("body").on("keydown.treeviewplug",(function(e){e.keyCode===n.ui.keyCode.ESCAPE&&(s.dropped=!1,s.cancel())})),s.trees=[],n(o.connectToTreeView).each((function(){var t=n.data(this,"apex-treeView");t&&!t.options.disabled&&t.options.dragAndDrop?(s.trees.push({instance:t}),t._initPositions(),t._refreshPositions(),t._trigger("activate",e,r)):i.warn("Draggable connectToTreeView matches an element that is not a treeView, is disabled, or doesn't support drag and drop.")}))},stop:function(e){var t=n(this).data("ui-draggable");n("body").off(".treeviewplug"),n.each(t.trees,(function(){this.instance.isOver&&!this.invalid?(this.instance.isOver=!1,t.cancelHelperRemoval=!0,this.instance._mouseStop(e,!0),e.target||(this.instance._trigger("deactivate",e,this.instance._uiHashDnD(this.instance)),this.instance.dragItems.parent().remove(),this.instance._cancel(e,!0))):(this.instance._deactivate(),this.instance._trigger("deactivate",e,this.instance._uiHashDnD(this.instance)),this.instance.dragItems&&(this.instance.dragItems.parent().remove(),this.instance._cancel(e,!0)))}))},drag:function(e,t){var i=n(this).data("ui-draggable");n.each(i.trees,(function(){var s=!1;if(!this.invalid)if(this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(s=!0),s){if(!this.instance.isOver){if(this.instance.isOver=!0,this.instance._makeTempDragItem(),this.instance.helper=t.helper,this.instance.helper.css("position","relative"),e.target=this.instance.dragItems.parent().children(d)[0],!this.instance._mouseCapture(e,!0))return this.instance.isOver=!1,void(this.invalid=!0);this.instance._trigger("over",e,this.instance._uiHashDnD(this.instance)),this.instance._mouseStart(e,e,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i}this.instance.dragItems&&this.instance._mouseDrag(e)}else this.instance.isOver&&(this.instance.isOver=!1,this.instance._trigger("out",e,this.instance._uiHashDnD(this.instance)),e.target=null,this.instance._mouseStop(e,!0),this.instance.dragItems.parent().remove(),this.instance.placeholder&&this.instance._removePlaceholder(),i.dropped=!1)}))}}),n.ui.plugin.add("draggable","cursor2",{start:function(){var e=n("body"),t=n(this).data("ui-draggable"),i=t.options;i.cursor2&&"auto"!==i.cursor2&&(t.storedCursor=e.css("cursor"),e.css("cursor",i.cursor2),t.storedStylesheet=n("<style>*{ cursor: "+i.cursor2+" !important; }</style>").appendTo(e))},stop:function(){var e=n(this).data("ui-draggable");e.storedCursor&&(n("body").css("cursor",e.storedCursor),e.storedStylesheet.remove())}})),apex.widget){var de={default:{operations:{canAdd:!1,canDelete:!1,canRename:!1,canDrag:!1}}};apex.widget.tree={init:function(i,s,o,r){var l=n("#"+t.escapeCSS(i),apex.gPageContext$);function a(t,i,s,n){e.plugin(i,{pageItems:s},{dataType:"json",refreshObject:t,loadingIndicator:t,loadingIndicatorPosition:"centered",success:function(e){n(e)}})}function d(e,t){var i;Array.isArray(t)&&t.length>0?e.treeView("setSelectedNodes",t,!1,!0):(i=e.treeView("find",{depth:-1,findAll:!1,match:function(e){return e.id===t}})).length>0&&e.treeView("setSelection",i)}r.regionStaticId&&r.lazyLoading?apex.widget.util.whenBecomesVisible(l,(function(e){!function(e,t,i,s){a(e,i,s,(function(i){var s=i.data||{},o=i.showRoot||!1,r=i.navigation||!1,l=i.hasIdentity||!0,a=j(!0,{},de),h=t.initialSelectedNodeId,c=t.nodeHasTooltip;t.defaultIcon&&(a.default.icon=t.defaultIcon),t=j({getNodeAdapter:function(){return(t.makeNodeAdapter||n.apex.treeView.makeDefaultNodeAdapter)(s,a,l)},tooltip:c?{show:apex.tooltipManager.defaultShowOption(),content:function(e,t){return t?t.tooltip:null}}:null,navigation:r,showRoot:o},t),e.treeView(t),d(e,h)}))}(e,r,r.ajaxIdentifier,r.itemsToSubmit)})):function(e,t,i,s){var o=j(!0,{},de),r=t.initialSelectedNodeId,l=t.nodeHasTooltip;t.defaultIcon&&(o.default.icon=t.defaultIcon);t=j({getNodeAdapter:function(){return(t.makeNodeAdapter||n.apex.treeView.makeDefaultNodeAdapter)(i,o,s)},tooltip:l?{show:apex.tooltipManager.defaultShowOption(),content:function(e,t){return t?t.tooltip:null}}:null,navigation:!0},t),e.treeView(t),d(e,r)}(l,r,s,o),r.regionStaticId&&apex.region.create(r.regionStaticId,{type:"Tree",widgetName:"treeView",refresh:function(){var e,t,i;e=l,t=r.ajaxIdentifier,i=r.itemsToSubmit,a(e,t,i,(function(t){var i,s=t.data||{},o=t.showRoot||!1,r=t.navigation||!1,l=t.hasIdentity||!0,a=e.treeView("getNodeAdapter"),h=function(e){return e.treeView("getSelectedNodes")}(e);a.getExpandedState?i=e.treeView("getExpandedNodeIds"):n.apex.treeView.addViewStateMixin(a,l,h),a.data=s,e.treeView("getNodeAdapter",(function(){return a})),e.treeView("option","showRoot",o),e.treeView("option","navigation",r),e.treeView("refresh"),function(e,t){if(t)for(let i=0;i<t.length;i++){let s=e.treeView("find",{depth:-1,findAll:!1,match:function(e){return e.id===t[i]}});s.length>0&&e.treeView("expand",s)}}(e,i),d(e,h)}))},focus:function(){l.treeView("focus")},widget:function(){return l}})},expand_all:function(e){n("#"+t.escapeCSS(e),apex.gPageContext$).treeView("expandAll")},collapse_all:function(e){n("#"+t.escapeCSS(e),apex.gPageContext$).treeView("collapseAll")},reset:function(e){var i=n("#"+t.escapeCSS(e),apex.gPageContext$);i.treeView("collapseAll").treeView("expand",i.children().children("li").first())}}}}(apex.server,apex.util,apex.debug,apex.actions,apex.jQuery);